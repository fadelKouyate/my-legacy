(this.webpackJsonpcov_gn=this.webpackJsonpcov_gn||[]).push([[29],{561:function(e,n,t){"use strict";var r=t(167),a=t(168),o=t(47),c=t(589),u=t(578),i=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,[{key:"arrayBufferToBase64",value:function(e){var n="";return[].slice.call(new Uint8Array(e)).forEach((function(e){return n+=String.fromCharCode(e)})),window.btoa(n)}}],[{key:"updateLastAction",value:function(){return{type:"UPDATE_LAST_ACTION"}}},{key:"updateUserInfo",value:function(n,t){return function(r){r({type:o.i,name:n,value:t}),r(e.updateLastAction())}}},{key:"updateMail",value:function(n){return function(t){t(e.updateUserInfo("cov_mail",n))}}},{key:"updateFirstName",value:function(n){return function(t){t(e.updateUserInfo("cov_first_name",n))}}},{key:"updateLastName",value:function(n){return function(t){t(e.updateUserInfo("cov_last_name",n))}}},{key:"updateBirth",value:function(n){return function(t){t(e.updateUserInfo("cov_birth",n))}}},{key:"updateGender",value:function(n){return function(t){t(e.updateUserInfo("cov_gender",n))}}},{key:"updateCity",value:function(n){return function(t){t(e.updateUserInfo("cov_city",n))}}},{key:"updatePassword",value:function(n){return function(t){t(e.updateUserInfo("cov_password",n))}}},{key:"updatePhone",value:function(n){return function(t){t(e.updateUserInfo("cov_phone",n))}}},{key:"updatePicture",value:function(n){return function(t){t(e.updateUserInfo("cov_picture",n))}}},{key:"checkMail",value:function(n){return function(t){return c.a.checkMail(n).then((function(r){t(e.updateMail(n))})).catch((function(e){throw e}))}}},{key:"saveUser",value:function(n){return function(t){return c.a.createAccount(n).then((function(n){t(e.updateLastAction())})).catch((function(e){throw e}))}}},{key:"connectUserSuccess",value:function(e,n){return{type:o.a,value:n,token:e}}},{key:"connectUser",value:function(n,t){return function(r){var a={cov_email:n,cov_password:t};return c.a.connect(a).then((function(t){var a=t.data.tokenType+" "+t.data.accessToken;return c.a.readAccount(n,a).then((function(n){var t=u.a.mappingData(n.data);r(e.connectUserSuccess(a,t)),r(e.updateLastAction())})).catch((function(e){throw e}))})).catch((function(e){throw e}))}}},{key:"updataUserSuccess",value:function(e){return{type:o.h,value:e}}},{key:"updateUser",value:function(n,t){return function(r){return c.a.updateAccount(n,t).then((function(n){r(e.updataUserSuccess(u.a.mappingData(n.data))),r(e.updateLastAction())})).catch((function(e){throw e}))}}},{key:"uploadPicture",value:function(n,t,r,a){return function(o){return c.a.uploadPicture(n,r,a).then((function(n){o(e.updatePicture(t))})).catch((function(e){throw e}))}}},{key:"updateUserPassword",value:function(n,t){return function(r){var a={cov_mail:n.cov_mail,cov_password:n.cov_password};return c.a.updatePassword(a,t).then((function(n){return r(e.updateLastAction()),n})).catch((function(e){throw e}))}}},{key:"logout",value:function(){return{type:o.b}}},{key:"forgotPassword",value:function(n){var t={cov_mail:n};return function(n){return c.a.forgotPassword(t).then((function(t){return n(e.updateLastAction()),t})).catch((function(e){throw e}))}}},{key:"initPassword",value:function(n,t){var r={cov_mail:n.cov_mail,cov_password:n.cov_password,token:t};return function(n){return c.a.initPassword(r).then((function(t){return n(e.updateLastAction()),t})).catch((function(e){throw e}))}}},{key:"validateUser",value:function(n){return function(t){return c.a.validateAccount(n).then((function(n){t(e.updateLastAction())})).catch((function(e){throw e}))}}},{key:"setPathName",value:function(e){return{type:o.d,value:e}}}]),e}();n.a=i},572:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"p",(function(){return a})),t.d(n,"q",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"c",(function(){return u})),t.d(n,"b",(function(){return i})),t.d(n,"n",(function(){return s})),t.d(n,"o",(function(){return l})),t.d(n,"e",(function(){return p})),t.d(n,"f",(function(){return f})),t.d(n,"h",(function(){return h})),t.d(n,"k",(function(){return d})),t.d(n,"j",(function(){return m})),t.d(n,"l",(function(){return v})),t.d(n,"g",(function(){return g})),t.d(n,"i",(function(){return y})),t.d(n,"m",(function(){return _})),t.d(n,"v",(function(){return k})),t.d(n,"u",(function(){return w})),t.d(n,"t",(function(){return b})),t.d(n,"s",(function(){return P})),t.d(n,"r",(function(){return A}));var r="/dashboard",a="/theme",o="/theme/typography",c="/login",u="/login/createTrip",i="/login/book_trip",s="/register",l="/register/validate",p="/page404",f="/page500",h="/profile/infos",d="/profile/password/forgot",m="/profile/password/change",v="/profile/password/init",g="/profile/driver_trips",y="/profile/passenger_trips",_="/profile/picture",k="/trip/show",w="/trip/show/detail",b="/trip/search",P="/trip/create",A="/trip/booking_info"},574:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"h",(function(){return a})),t.d(n,"m",(function(){return o})),t.d(n,"q",(function(){return c})),t.d(n,"s",(function(){return u})),t.d(n,"g",(function(){return i})),t.d(n,"i",(function(){return s})),t.d(n,"t",(function(){return l})),t.d(n,"f",(function(){return p})),t.d(n,"l",(function(){return f})),t.d(n,"k",(function(){return h})),t.d(n,"j",(function(){return d})),t.d(n,"r",(function(){return m})),t.d(n,"p",(function(){return v})),t.d(n,"c",(function(){return g})),t.d(n,"n",(function(){return y})),t.d(n,"o",(function(){return _})),t.d(n,"b",(function(){return k})),t.d(n,"d",(function(){return w})),t.d(n,"e",(function(){return b}));var r="http://localhost:8080",a="/cov/auth/signin",o="/cov/ws_read_account",c="/cov/ws_update_account",u="/cov/auth/ws_upload_picture",i="/cov/auth/ws_check_email",s="/cov/auth/ws_create_account",l="/cov/auth/ws_validate_account",p="/cov/ws_change_password",f="/cov/ws_reset_password",h="/cov/auth/ws_forgot_password",d="/cov/auth/trip/ws_create_trip",m="/cov/auth/trip/ws_update_trip",v="/cov/auth/trip/ws_search_trip",g="/cov/auth/trip/ws_book_trip",y="/cov/auth/trip/ws_read_driver_trips",_="/cov/auth/trip/ws_read_passenger_trips",k="/cov/auth/trip/ws_booking_validation",w="/cov/auth/trip/ws_cancel_booking",b="/cov/auth/trip/ws_cancel_driver_trip"},578:function(e,n,t){"use strict";var r=t(167),a=t(168),o={cov_mail:{title:"Votre adresse mail ?",errorMessage:"Email incorrect",regex:"^\\S+@\\S+\\.\\S+$"},cov_names:{title:"Votre prenom et nom ?",errorMessage:"Saisir entre 5 \xe0 30 caract\xe8res",regex:"^(.{5,30})$"},cov_birth:{title:"Votre date de naissance ?",errorMessage:"Saisir la date de naissance ou ignorer le champ",regex:"|^[0-9]{4}[-][0-9]{2}[-][0-9]{2}$"},cov_password:{title:"Votre mot de passe ?",errorMessage:"Saisir un mot de passe de 5 \xe0 30 caract\xe8res",regex:"^(.{5,30})$"},cov_gender:{title:"Vous \xeates ?",errorMessage:"Faites un choix",regex:"^(.{1,1})$"},cov_phone:{title:"Votre num\xe9ro de t\xe9l\xe9phone ?",errorMessage:"Saisir un num\xe9ro de t\xe9l\xe9phone de 10 chiffres",regex:"^(\\d{10,10})$"},cov_city:{title:"Votre ville ?",errorMessage:"Saisir un nom de ville",regex:"^(.{1,100})$"}},c=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,null,[{key:"mappingData",value:function(e){return{cov_mail:e.email,cov_first_name:e.fname,cov_last_name:e.lname,cov_birth:e.birth,cov_gender:e.gender,cov_phone:e.phone,cov_city:e.city,cov_picture:e.picture,cov_description:e.description}}},{key:"checkValue",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=o[e],a=new RegExp(r.regex),c=a.test(n),u=c?"":r.errorMessage,i=c?"":t;return{resultat:c,message:u,errorStep:i}}},{key:"sleep",value:function(e){return new Promise((function(n){return setTimeout(n,1e3*e)}))}}]),e}();n.a=c},589:function(e,n,t){"use strict";var r=t(557),a=t.n(r),o=t(558),c=t(167),u=t(168),i=t(574),s=t(579),l=t.n(s),p=t(596),f=t.n(p),h=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,null,[{key:"handleError",value:function(e){console.log("Axios err donne la valeur: ",e);var n=JSON.parse(JSON.stringify(e)).message;try{var t=n.match("\\d{3}");return t&&t.length>0?parseInt(t[0].trim()):f.a.INTERNAL_SERVER_ERROR}catch(e){return f.a.INTERNAL_SERVER_ERROR}}},{key:"createAccount",value:function(e){var n=i.a+i.i,t=JSON.stringify(e),r=JSON.parse(t);return l.a.post(n,r).then((function(e){return e})).catch((function(e){throw console.log(e),e}))}},{key:"updateAccount",value:function(e,n){var t=i.a+i.q,r=JSON.stringify(e),a=JSON.parse(r),o={Authorization:"Bearer "+n};return l.a.post(t,a,{headers:o}).then((function(e){return e})).catch((function(e){throw console.log(e),e}))}},{key:"uploadPicture",value:function(e,n,t){var r=i.a+i.s,a=new FormData;a.append("cov_email",e),a.append("cov_picture",n);var o={Authorization:"Bearer "+t};return l.a.post(r,a,{headers:o}).then((function(e){return console.log(e.data),e})).catch((function(e){throw console.log(e),e}))}},{key:"validateAccount",value:function(e){var n=i.a+i.t+"?token="+e;return l.a.get(n).then((function(e){return e})).then((function(e){return"VALID"===e.data.accountStatus?f.a.OK:f.a.NOT_MODIFIED})).catch((function(e){throw console.log(e),e}))}},{key:"checkMail",value:function(){var e=Object(o.a)(a.a.mark((function e(n){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.a+i.g+"?cov_email="+n,e.prev=1,e.next=4,l.a.get(t);case 4:return r=e.sent,e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(1),console.log(e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}()},{key:"connect",value:function(e){var n=i.a+i.h,t=JSON.stringify(e),r=JSON.parse(t);return l.a.post(n,r).then((function(e){return e})).catch((function(e){throw e}))}},{key:"readAccount",value:function(e,n){var t=i.a+i.m+"?email="+e,r={Authorization:"Bearer "+n};return l.a.get(t,{headers:r}).then((function(e){return e})).then((function(e){return{status:f.a.OK,data:e.data}})).catch((function(e){throw console.log(e),e}))}},{key:"updatePassword",value:function(e,n){var t=i.a+i.f,r=JSON.stringify(e),a=JSON.parse(r),o={Authorization:"Bearer "+n};return l.a.post(t,a,{headers:o}).then((function(e){return e})).catch((function(e){throw console.log(e),e}))}},{key:"forgotPassword",value:function(e){var n=i.a+i.k;return l.a.post(n,e).then((function(e){return e})).catch((function(e){throw console.log(e),e}))}},{key:"initPassword",value:function(e){var n=i.a+i.l,t=JSON.stringify(e),r=JSON.parse(t);return l.a.post(n,r).then((function(e){return e})).catch((function(e){throw console.log(e),e}))}}]),e}();n.a=h},832:function(e,n,t){"use strict";t.r(n);var r=t(167),a=t(168),o=t(172),c=t(170),u=t(169),i=t(1),s=t.n(i),l=t(20),p=t(174),f=t(797),h=t(171),d=t(568),m=t.n(d),v=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,null,[{key:"isAccess",value:function(e){var n=m()(parseInt(e,10));return m()(Date.now()).diff(n,"milliseconds")/1e3<500}}]),e}(),g=t(561),y=function(e){Object(c.a)(t,e);var n=Object(u.a)(t);function t(e){var a;return Object(r.a)(this,t),(a=n.call(this,e)).state={},a}return Object(a.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)(g.a.setPathName(this.props.path))}},{key:"render",value:function(){return s.a.createElement(l.c,{to:"/login"})}}]),t}(i.Component),_=Object(h.b)((function(e){return{pathname:e.pathname}}))(y),k=t(651),w={items:[{name:"Mon compte",url:"/",icon:"icon-user"},{title:!0,name:"Profil",wrapper:{element:"",attributes:{}},class:""},{name:"Mes informations",url:"/profile/infos",icon:"icon-drop"},{name:"Photo",url:"/profile/picture",icon:"icon-camera"},{name:"V\xe9hicule",url:"/theme/typography",icon:"icon-pencil"},{title:!0,name:"Mes Trajets",wrapper:{element:"",attributes:{}},class:""},{name:"Je suis conducteur",url:"/profile/driver_trips",icon:"icon-drop"},{name:"Je suis passager",url:"/profile/passenger_trips",icon:"icon-drop"},{title:!0,name:"Pr\xe9f\xe9rences",wrapper:{element:"",attributes:{}},class:""},{name:"Mot de passe",url:"/profile/password/change",icon:"icon-lock"},{name:"V\xe9rification",url:"/theme/typography",icon:"icon-eye"}]},b=t(572),P=s.a.lazy((function(){return t.e(40).then(t.bind(null,805))})),A=s.a.lazy((function(){return Promise.all([t.e(39),t.e(41)]).then(t.bind(null,806))})),O=s.a.lazy((function(){return t.e(42).then(t.bind(null,807))})),E=s.a.lazy((function(){return Promise.all([t.e(18),t.e(35)]).then(t.bind(null,808))})),S=s.a.lazy((function(){return Promise.all([t.e(14),t.e(34)]).then(t.bind(null,809))})),x=s.a.lazy((function(){return t.e(26).then(t.bind(null,810))})),z=s.a.lazy((function(){return t.e(27).then(t.bind(null,811))})),N=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(3),t.e(25)]).then(t.bind(null,833))})),T=s.a.lazy((function(){return Promise.all([t.e(0),t.e(2),t.e(9),t.e(24)]).then(t.bind(null,834))})),j=s.a.lazy((function(){return Promise.all([t.e(1),t.e(13),t.e(38)]).then(t.bind(null,820))})),I=s.a.lazy((function(){return Promise.all([t.e(15),t.e(36)]).then(t.bind(null,821))})),U=s.a.lazy((function(){return Promise.all([t.e(12),t.e(37)]).then(t.bind(null,822))})),M=s.a.lazy((function(){return Promise.all([t.e(0),t.e(17),t.e(33)]).then(t.bind(null,839))})),L=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(11),t.e(32)]).then(t.bind(null,823))})),R=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(21)]).then(t.bind(null,824))})),D=s.a.lazy((function(){return t.e(22).then(t.bind(null,840))})),J=s.a.lazy((function(){return Promise.all([t.e(0),t.e(2),t.e(23)]).then(t.bind(null,825))})),V=s.a.lazy((function(){return Promise.all([t.e(0),t.e(10)]).then(t.bind(null,841))})),C=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(20)]).then(t.bind(null,831))})),B=s.a.lazy((function(){return Promise.all([t.e(0),t.e(16),t.e(28)]).then(t.bind(null,826))})),$=s.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(19)]).then(t.bind(null,827))})),F=[{path:"/",exact:!0,name:"Home",component:T},{path:b.a,name:"Dashboard",component:P},{path:b.p,exact:!0,name:"Theme",component:A},{path:b.q,name:"Typography",component:O,check:!0},{path:b.c,name:"Login",component:S,gotoAfter:"CREATE_TRIP"},{path:b.b,name:"Login",component:S,gotoAfter:"BOOK_TRIP"},{path:b.d,name:"Login",component:S,check:!1,gotoAfter:"DASHBORD"},{path:b.n,exact:!0,name:"Create",component:N,check:!1},{path:b.o,name:"Register",component:D,check:!1},{path:b.e,name:"Page404",component:x},{path:b.f,name:"Typography",component:z},{path:b.h,exact:!0,name:"Profile",component:E,check:!0},{path:b.k,exact:!0,name:"Forgot",component:j,check:!1},{path:b.j,exact:!0,name:"Change",component:I,check:!0},{path:b.l,exact:!0,name:"Init",component:U,check:!1},{path:b.g,exact:!0,name:"driverTrips",component:L,check:!0},{path:b.i,exact:!0,name:"passengerTrips",component:R,check:!0},{path:b.m,name:"Picture",component:M,check:!0},{path:b.t,name:"SearchTrip",component:J},{path:b.v+"/:trip_from/:trip_to/:trip_date/:trip_place",name:"ShowAllTrips",component:V},{path:b.u+"/:trip_reference",name:"ShowTripDetail",component:B,check:!1},{path:b.u,name:"ShowTripDetail",component:B,check:!0},{path:b.s,name:"CreateTrip",component:C,check:!0},{path:b.r,name:"/BookingTripInfo",component:$,check:!0}],q=s.a.lazy((function(){return t.e(30).then(t.bind(null,836))})),K=s.a.lazy((function(){return Promise.all([t.e(0),t.e(8),t.e(31)]).then(t.bind(null,798))})),H=function(e){Object(c.a)(t,e);var n=Object(u.a)(t);function t(e){var a;return Object(r.a)(this,t),(a=n.call(this,e)).state={refSetInterval:""},a.checkAccess=a.checkAccess.bind(Object(o.a)(a)),a}return Object(a.a)(t,[{key:"loading",value:function(){return s.a.createElement("div",{className:"animated fadeIn pt-1 text-center"},"Loading...")}},{key:"typeAccess",value:function(e,n){return e&&!1===n?0:e||!0!==n?2:1}},{key:"checkAccess",value:function(){var e=this.props.auth.logged;if(console.log("log donne ",e),e){console.log("i am in access");var n=this.props,t=n.dispatch,r=n.action_date;v.isAccess(r)||t(g.a.logout())}}},{key:"componentDidMount",value:function(){var e=this.props.auth.logged,n=parseInt(500);console.log("log donne , timeTo",e," ",n),e&&this.checkAccess()}},{key:"render",value:function(){var e=this,n=this.props.auth.logged,t=this.props.dispatch,r=this.props.location.pathname,a=r.startsWith("/profile")?"sidebar-fixed":"sidebar-hidden";return s.a.createElement("div",{className:"app"},s.a.createElement(k.b,{fixed:!0},s.a.createElement(i.Suspense,{fallback:this.loading()},s.a.createElement(K,{logged:n,dispatch:t,currentPage:r,history:this.props.history}))),s.a.createElement("div",{className:"app-body"},n&&r.startsWith("/profile")&&-1===r.indexOf("forgot")&&-1===r.indexOf("init")?s.a.createElement(k.d,{className:a,display:"lg"},s.a.createElement(k.g,null),s.a.createElement(k.f,null),s.a.createElement(i.Suspense,null,s.a.createElement(k.i,{navConfig:w,router:p})),s.a.createElement(k.e,null),s.a.createElement(k.h,null)):"",s.a.createElement("main",{className:"main"},s.a.createElement(f.a,{fluid:!0},s.a.createElement(i.Suspense,{fallback:this.loading()},s.a.createElement(l.g,null,F.map((function(t,r){var a={idx:r},o=e.typeAccess(n,t.check);return 2===o?s.a.createElement(l.d,{key:r,path:t.path,exact:t.exact,name:t.name,render:function(e){return s.a.createElement(t.component,Object.assign({},e,{gotoAfter:t.gotoAfter}))}}):1===o?s.a.createElement(_,{key:a,path:t.path}):null})),s.a.createElement(l.c,{from:"/",to:"/"})))))),s.a.createElement(k.a,null,s.a.createElement(i.Suspense,{fallback:this.loading()},s.a.createElement(q,null))))}}]),t}(i.Component);n.default=Object(h.b)((function(e){return{action_date:e.action_date,auth:e.auth,logged:e.auth.logged}}))(H)}}]);
//# sourceMappingURL=29.dd8e3ab4.chunk.js.map